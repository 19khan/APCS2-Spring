package textExcel;

public class FormulaCell extends RealCell {
	private String [] equation;
	
	public FormulaCell (String input) {
		super(input);
		equation = input.substring(2, input.length()-2).split(" ");
	}
	
	public String abbreviatedCellText(){
		return solve(0,0)+"                ".substring(0,10);
	}
	
	public String fullCellText() {
		return super.fullCellText();
	}
	
	public double solve (int position, double answer) {
		if (position == equation.length-2){
			return answer;
		}else {
			if (equation [position + 1].equals("+")){
				answer = getDoubleValue(equation[position]) + getDoubleValue(equation[position + 2]);//add
			}else if (equation [position + 1].equals("-")){
				answer = getDoubleValue(equation[position]) - getDoubleValue(equation[position + 2]);//subtract
			}else if (equation [position + 1].equals("*")){
				answer = getDoubleValue(equation[position]) * getDoubleValue(equation[position + 2]);//multiply
			}else if (equation [position + 1].equals("/")){
				answer = getDoubleValue(equation[position]) / getDoubleValue(equation[position + 2]);//divide
			}
			return answer + solve(position+3, 0);
		}
	}
	
	public double getDoubleValue (String number) {
		return Double.parseDouble(number);
	}
	
	public String getType(){
		return "FormulaCell";
	}
}
